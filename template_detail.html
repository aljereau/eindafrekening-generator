<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <title>Detail Afrekening {{ client.name }}</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Barlow:wght@400;500;600;700&family=Work+Sans:wght@300;400;500;600&display=swap');

        :root {
            --color-primary: #E85D45;
            --color-secondary: #2C2C2C;
            --color-text-main: #1A1A1A;
            --color-text-muted: #616161;
            --color-text-light: #9E9E9E;
            --color-bg-page: #FFFFFF;
            --color-bg-surface: #F8F9FA;
            --color-border: #E0E0E0;
            --spacing-sm: 8px;
            --spacing-md: 16px;
            --spacing-lg: 24px;
            --spacing-xl: 32px;
            --radius-sm: 6px;
            --radius-md: 12px;
        }

        @page {
            size: A4 portrait;
            margin: 15mm;
        }

        body {
            font-family: 'Work Sans', sans-serif;
            color: var(--color-text-main);
            background-color: var(--color-bg-page);
            margin: 0;
            padding: 20px;
            font-size: 13px;
            line-height: 1.6;
        }

        h1, h2, h3 {
            font-family: 'Barlow', sans-serif;
        }

        .header {
            border-bottom: 2px solid var(--color-primary);
            padding-bottom: var(--spacing-lg);
            margin-bottom: var(--spacing-xl);
        }

        .header h1 {
            margin: 0;
            font-size: 28px;
            color: var(--color-secondary);
        }

        .header .subtitle {
            font-size: 16px;
            color: var(--color-text-muted);
            margin: 4px 0;
        }

        .header .period {
            font-size: 14px;
            color: var(--color-text-light);
        }

        .section {
            margin-bottom: var(--spacing-xl);
            break-inside: avoid;
        }

        .section-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--color-secondary);
            border-left: 4px solid var(--color-primary);
            padding-left: 12px;
            margin-bottom: var(--spacing-md);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: var(--spacing-md) 0;
            break-inside: avoid;
        }

        table thead {
            background: var(--color-bg-surface);
        }

        table th {
            text-align: left;
            padding: 10px 12px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--color-text-muted);
            border-bottom: 2px solid var(--color-border);
        }

        table td {
            padding: 8px 12px;
            border-bottom: 1px solid var(--color-border);
        }

        table tr:last-child td {
            border-bottom: none;
        }

        table .text-right {
            text-align: right;
        }

        table .text-bold {
            font-weight: 600;
        }

        .totals-row {
            background: #FFF5F2;
            font-weight: 600;
        }

        .meter-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--spacing-md);
            margin: var(--spacing-md) 0;
        }

        .meter-card {
            background: var(--color-bg-surface);
            padding: var(--spacing-md);
            border-radius: var(--radius-md);
            border-left: 3px solid var(--color-primary);
        }

        .meter-label {
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--color-secondary);
        }

        .meter-values {
            font-size: 12px;
            color: var(--color-text-muted);
        }

        .meter-values div {
            margin: 4px 0;
        }

        .footer {
            margin-top: var(--spacing-xl);
            padding-top: var(--spacing-md);
            border-top: 1px solid var(--color-border);
            text-align: center;
            font-size: 11px;
            color: var(--color-text-light);
        }

        .summary-box {
            background: linear-gradient(135deg, #FFF5F2 0%, #FFFFFF 100%);
            border: 2px solid var(--color-primary);
            padding: var(--spacing-md);
            border-radius: var(--radius-md);
            margin: var(--spacing-md) 0;
        }

        .summary-box .label {
            font-size: 12px;
            color: var(--color-text-muted);
            margin-bottom: 4px;
        }

        .summary-box .value {
            font-size: 20px;
            font-weight: 700;
            color: var(--color-primary);
        }
    </style>
</head>
<body>

    <!-- HEADER -->
    <div class="header">
        <h1>üè† Gedetailleerde Afrekening</h1>
        <div class="subtitle">{{ client.name }}</div>
        <div class="subtitle">{{ client.object_address }}</div>
        <div class="period">Verblijfsperiode: {{ client.period.checkin_date }} - {{ client.period.checkout_date }}</div>
    </div>

    <!-- GWE SECTION -->
    <div class="section">
        <h2 class="section-title">‚ö° Gas / Water / Elektra</h2>
        
        <h3 style="font-size: 14px; margin-top: var(--spacing-lg);">Meterstanden</h3>
        <div class="meter-grid">
            <div class="meter-card">
                <div class="meter-label">üîå Elektra (kWh)</div>
                <div class="meter-values">
                    <div>Begin: {{ gwe.meterstanden.stroom.begin }}</div>
                    <div>Eind: {{ gwe.meterstanden.stroom.eind }}</div>
                    <div style="font-weight: 600; color: var(--color-secondary);">
                        Verbruik: {{ gwe.meterstanden.stroom.verbruik }} kWh
                    </div>
                </div>
            </div>
            <div class="meter-card">
                <div class="meter-label">üî• Gas (m¬≥)</div>
                <div class="meter-values">
                    <div>Begin: {{ gwe.meterstanden.gas.begin }}</div>
                    <div>Eind: {{ gwe.meterstanden.gas.eind }}</div>
                    <div style="font-weight: 600; color: var(--color-secondary);">
                        Verbruik: {{ gwe.meterstanden.gas.verbruik }} m¬≥
                    </div>
                </div>
            </div>
        </div>

        <h3 style="font-size: 14px; margin-top: var(--spacing-lg);">Kostenspecificatie</h3>
        <table>
            <thead>
                <tr>
                    <th>Omschrijving</th>
                    <th class="text-right">Verbruik/Dagen</th>
                    <th class="text-right">Tarief (excl. BTW)</th>
                    <th class="text-right">Kosten (excl. BTW)</th>
                </tr>
            </thead>
            <tbody>
                {% for regel in gwe.kostenregels %}
                <tr>
                    <td>{{ regel.omschrijving }}</td>
                    <td class="text-right">{{ "%.2f"|format(regel.verbruik_of_dagen) }}</td>
                    <td class="text-right">‚Ç¨{{ "%.4f"|format(regel.tarief_excl) }}</td>
                    <td class="text-right">‚Ç¨{{ "%.2f"|format(regel.kosten_excl) }}</td>
                </tr>
                {% endfor %}
                <tr class="totals-row">
                    <td colspan="3" class="text-bold">Totaal excl. BTW</td>
                    <td class="text-right text-bold">‚Ç¨{{ "%.2f"|format(gwe.totalen.totaal_excl) }}</td>
                </tr>
                <tr>
                    <td colspan="3">BTW 21%</td>
                    <td class="text-right">‚Ç¨{{ "%.2f"|format(gwe.totalen.btw) }}</td>
                </tr>
                <tr class="totals-row" style="background: var(--color-primary); color: white;">
                    <td colspan="3" class="text-bold" style="border: none;">Totaal incl. BTW</td>
                    <td class="text-right text-bold" style="border: none;">‚Ç¨{{ "%.2f"|format(gwe.totalen.totaal_incl) }}</td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- CLEANING SECTION -->
    <div class="section">
        <h2 class="section-title">üßπ Schoonmaak</h2>
        
        <div class="summary-box">
            <div class="label">Schoonmaakpakket</div>
            <div class="value">{{ cleaning.pakket_type.replace('_', ' ').title() }}</div>
        </div>

        <table>
            <thead>
                <tr>
                    <th>Omschrijving</th>
                    <th class="text-right">Uren</th>
                    <th class="text-right">Tarief</th>
                    <th class="text-right">Bedrag</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Basis pakket (inbegrepen)</td>
                    <td class="text-right">{{ "%.1f"|format(cleaning.inbegrepen_uren) }}</td>
                    <td class="text-right">‚Ç¨{{ "%.2f"|format(cleaning.uurtarief) }}</td>
                    <td class="text-right">‚Ç¨{{ "%.2f"|format(cleaning.voorschot) }}</td>
                </tr>
                {% if cleaning.extra_uren > 0 %}
                <tr>
                    <td>Extra uren nodig</td>
                    <td class="text-right">{{ "%.1f"|format(cleaning.extra_uren) }}</td>
                    <td class="text-right">‚Ç¨{{ "%.2f"|format(cleaning.uurtarief) }}</td>
                    <td class="text-right">‚Ç¨{{ "%.2f"|format(cleaning.extra_bedrag) }}</td>
                </tr>
                {% endif %}
                <tr class="totals-row">
                    <td class="text-bold">Totaal uren gewerkt</td>
                    <td class="text-right text-bold">{{ "%.1f"|format(cleaning.totaal_uren) }}</td>
                    <td></td>
                    <td class="text-right text-bold">‚Ç¨{{ "%.2f"|format(cleaning.voorschot + cleaning.extra_bedrag) }}</td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- DAMAGE SECTION -->
    <div class="section">
        <h2 class="section-title">üîí Schade & Borg</h2>
        
        {% if damage.regels %}
        <table>
            <thead>
                <tr>
                    <th>Beschrijving</th>
                    <th class="text-right">Aantal</th>
                    <th class="text-right">Tarief (excl. BTW)</th>
                    <th class="text-right">Bedrag (excl. BTW)</th>
                </tr>
            </thead>
            <tbody>
                {% for regel in damage.regels %}
                <tr>
                    <td>{{ regel.beschrijving }}</td>
                    <td class="text-right">{{ "%.0f"|format(regel.aantal) }}</td>
                    <td class="text-right">‚Ç¨{{ "%.2f"|format(regel.tarief_excl) }}</td>
                    <td class="text-right">‚Ç¨{{ "%.2f"|format(regel.bedrag_excl) }}</td>
                </tr>
                {% endfor %}
                <tr class="totals-row">
                    <td colspan="3" class="text-bold">Totaal excl. BTW</td>
                    <td class="text-right text-bold">‚Ç¨{{ "%.2f"|format(damage.totalen.totaal_excl) }}</td>
                </tr>
                <tr>
                    <td colspan="3">BTW 21%</td>
                    <td class="text-right">‚Ç¨{{ "%.2f"|format(damage.totalen.btw) }}</td>
                </tr>
                <tr class="totals-row">
                    <td colspan="3" class="text-bold">Totaal incl. BTW</td>
                    <td class="text-right text-bold">‚Ç¨{{ "%.2f"|format(damage.totalen.totaal_incl) }}</td>
                </tr>
            </tbody>
        </table>
        {% else %}
        <div style="padding: var(--spacing-md); background: var(--color-bg-surface); border-radius: var(--radius-md); text-align: center;">
            <p style="color: var(--color-text-muted); margin: 0;">‚úÖ Geen schade geregistreerd</p>
        </div>
        {% endif %}

        <h3 style="font-size: 14px; margin-top: var(--spacing-lg);">Borg Overzicht</h3>
        <table>
            <tbody>
                <tr>
                    <td>Borg Voorschot</td>
                    <td class="text-right">‚Ç¨{{ "%.2f"|format(borg.voorschot) }}</td>
                </tr>
                <tr>
                    <td>Borg Gebruikt (schade)</td>
                    <td class="text-right">‚Ç¨{{ "%.2f"|format(borg.gebruikt) }}</td>
                </tr>
                <tr class="totals-row">
                    <td class="text-bold">Borg Terug</td>
                    <td class="text-right text-bold">‚Ç¨{{ "%.2f"|format(borg.terug) }}</td>
                </tr>
                {% if borg.restschade > 0 %}
                <tr>
                    <td style="color: var(--color-primary);">Restschade (boven borg)</td>
                    <td class="text-right" style="color: var(--color-primary);">‚Ç¨{{ "%.2f"|format(borg.restschade) }}</td>
                </tr>
                {% endif %}
            </tbody>
        </table>
    </div>

    <!-- FOOTER -->
    <div class="footer">
        <strong>RyanRent</strong> | Detail Afrekening<br>
        Voor vragen: info@ryanrent.nl<br>
        Zie ook: OnePager overzicht voor vereenvoudigd overzicht
    </div>

</body>
</html>

